# Copilot Instructions for cargos-salarios

## Build & Dev Commands

```bash
npm install            # Install dependencies
npm run dev            # Start Vite dev server (http://localhost:5173)
npm run build          # Build for production to dist/
```

**Note:** No linting, tests, or formatters are configured. Code quality depends on manual review.

## Supabase Setup

Configuration is loaded from `.env.local`:
- `VITE_SUPABASE_URL` — Supabase project URL
- `VITE_SUPABASE_ANON_KEY` — Anonymous public key

Credentials are already populated for the existing project. For a new project, update `.env.local` with new values. The Supabase client is initialized in `src/lib/supabase.ts` and exported for reuse.

## Architecture Overview

### SPA without Routing
Navigation is view-state controlled via `useState('dashboard')` in `App.tsx`. No React Router. `App` conditionally renders:
- Dashboard
- TlpPanel
- VacancyManagement
- Requisitions
- DatabaseDemo

### Providers
Located in `App.tsx`:
- **ThemeProvider** — Dark/light mode toggle via `.dark` class on `<html>`, persisted to localStorage
- **SidebarProvider** — Sidebar collapsed/expanded state

### Data Flow
- **Backend:** Supabase JS Client (`src/lib/supabase.ts`) + Edge Function (`make-server-068aaf90`)
- **Data hooks** (`src/app/hooks/useSupabase.ts`): `useDashboardStats`, `useTlpData`, `useVacancies`, `useRequisitions`
  - All use vanilla `useState`/`useEffect` (no TanStack Query)
  - Call `fetchAPI()` to invoke Edge Function with Supabase client
- **Authentication** (`useAuth()` hook): 
  - Login via RPC `login_analista(email, senha)`
  - Session stored in localStorage (`auth_user` key)
  - Password change via RPC `change_password_analista(email, senha_atual, senha_nova)`

### Dashboard Features
- Filterable by `nome_fantasia` (healthcare units) with "Ver Todos" as default
- Filter persisted to localStorage, restored on reload
- Employee table shows: matrícula, name, cargo, unidade, situação
- Displays first 20 records with total count

## Tech Stack & Conventions

### Core Stack
- **Vite 6** + **React 18** + **TypeScript** (no `tsconfig.json` — inherited from Figma Make export)
- **Tailwind CSS v4** via `@tailwindcss/vite` plugin (no `tailwind.config.js`)
  - Base config: `src/styles/tailwind.css` (imports tailwindcss, sets `@source`)
  - Theme & utilities: `src/styles/theme.css` (CSS variables, `@theme inline`, `@layer base`)
  - Dark mode uses `@custom-variant dark (&:is(.dark *))` instead of default selector

### UI & Styling
- **shadcn/ui** (Radix UI primitives) in `src/app/components/ui/`
- **Icons:** lucide-react
- **Charts:** recharts
- **CSS utility:** `cn()` in `src/app/components/ui/utils.ts` (combines clsx + tailwind-merge)

### Path Alias
`@/` resolves to `./src` (configured in `vite.config.ts`)

## Key Files & Their Purpose

| File | Purpose |
|------|---------|
| `src/app/App.tsx` | Root component with providers and view routing |
| `src/app/hooks/useSupabase.ts` | Data fetching hooks for all pages |
| `src/app/hooks/useAuth.ts` | Authentication state and methods |
| `src/lib/supabase.ts` | Supabase client initialization |
| `src/app/components/ui/` | Reusable UI components (shadcn/ui) — avoid manual edits |
| `src/app/components/figma/` | Figma Make helpers — auto-generated |
| `utils/supabase/info.tsx` | Supabase credentials info — auto-generated |
| `vite.config.ts` | Vite build config (React + Tailwind plugins required) |
| `src/styles/` | Global CSS (Tailwind, theme, fonts) |

## Important Constraints & Warnings

1. **Auto-generated Files**
   - `utils/supabase/info.tsx` and `src/app/components/ui/` are generated by Figma Make
   - Manual edits may be overwritten on re-export
   - Avoid editing unless absolutely necessary

2. **Vite Asset Includes**
   - Only SVG (`**/*.svg`) and CSV (`**/*.csv`) are configured for raw imports
   - **Never add `.css`, `.tsx`, or `.ts` to `assetsInclude`** in `vite.config.ts`
   - Both React and Tailwind plugins in `vite.config.ts` are required even if not actively used

3. **PostCSS Config**
   - `postcss.config.mjs` is intentionally empty
   - Tailwind v4 configuration is entirely via the Vite plugin

4. **Testing & Linting**
   - No test suite or linter configured
   - Remove temporary test files if created — keep repo clean

5. **Supabase Views**
   - All views must be created in the `view` schema, not `public`

## Domain Context

This is an HR management system for Brazilian public health organizations (UPAs, Hospitals, UBSs). Key terminology:
- **TLP** — Tabela de Lotação de Pessoal (Personnel Staffing Table)
- **Saldo de vagas** — Vacancy balance
- **Requisições** — Personnel requests
- **nome_fantasia** — Unit name / Fantasy name
